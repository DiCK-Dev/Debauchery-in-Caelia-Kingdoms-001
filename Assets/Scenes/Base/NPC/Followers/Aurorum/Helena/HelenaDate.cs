using UnityEngine;
using System.Collections;
using UnityEngine.UI;

public class HelenaDate : MonoBehaviour {

	static int iHelena; 
	public Text Board; 
	int randNum;
	public Canvas endTurnPanel; 
	public Canvas panMainPanel;
	static string sirPronoun, lordPronoun; 


	public void helenaDate(){
		loadHelenaData ();
		if (GameControl.mcGender == GameControl.MCGender.FEMALE) {
			sirPronoun = "Ma'am";
			lordPronoun = "Lady";
		} else {
			sirPronoun = "Sir";
			lordPronoun = "Lord";
		}


		if (NPCCharList.CharFollower [iHelena].charRelationship < 20 ) {
			Board.text = "You need to improve your relationship with Helena before she agrees to date with you.";
			return; 
		}

		if (NPCCharList.CharFollower [iHelena].charLove < 50) {
			Board.text = date0 ();
		} else {
			Board.text = date1 ();

		}

		NPCCharList.CharFollower [iHelena].charLove += 20;
		if (NPCCharList.CharFollower [iHelena].charLove > 100) {
			NPCCharList.CharFollower [iHelena].charLove = 100;

		}

		endTurnFun ();
	}

	string date0(){
		Random.InitState (WorldControl.day * System.DateTime.Now.Millisecond + WorldControl.dayTime); 
		randNum = Random.Range (0, 100);
		if (randNum > 50) {
			return "You’ve been getting to know Helena for the past few days, about her grim situation, and the harsh past that she carries. When you moved to Aurorum, the only person that showed you genuine, true friendship as well as loyalty from the start was her. While the roles you have are of "+lordPronoun+" and Servant, you cannot forget your humble roots within the forest, and the bond the two of you have.  You know that the value of a person resides not in their wealth or luck but in their actions, and she has proved to you that she is worth your attention and respect. \n\nWhen you arrive in your throne room, you notice Helena moping off to the side, carrying a sad gaze. She doesn’t notice you till you are at her side, and she stumbles back a few steps in surprise. You ask her if she is fine, but she replies with a heavy sigh.<i>“Yeah, everything is fine for once. It’s just that I feel somewhat… nostalgic, I think? Things are going better than they have ever been, but I still feel… empty. Deep down, I still miss my family. I mean they were never great to me, but they were something I could always come back to, waiting for me… and that’s always something, right?”</i>\n\nYou slowly move close to her and embracing her with your warmth. She flushes red at the action but doesn’t refuse you. You tell her that she is right, that you barely know what is like to have someone waiting for you at home, but lacking that comfort and certainty could bother anyone, even her. \n\nShe gives you a sad smile that warms your heart, and you tell her that you have something to cheer up, signaling her to follow you. <i>“But "+ sirPronoun+", my job is not done yet!”</i> She exclaims, but you tell her to forget about that and drag her away before she can object. \n\nYou lead her into one of the finest cafes in the city. You tell the approaching waiter to free up the terrace for you and your guest. His face is about to scoff at your request until he realizes who you are, immediately bowing to you and Helena before ordering the staff to prepare the terrace at once. Helena squirms a bit, uncomfortable at all the commotion and effort that has been brought on by your command on behest of her. Maybe a surprise dat is too much, or at least an extremely jarring shift from her lifestyle? Regardless, the amazing pastries baked here would make those worries of hers disappear.\n\nWhen the terrace is ready for you, both of you are led to the second floor of the building, arriving at a completely desolate enviornment. You and Helena take a seat, assisted by your waiter, as you gaze on the wonderful view presented. Although you are just in the second floor, the cafe is located on a small hill overlooking the whole city. The fresh air is a nice change of pace compared to the stale air of your kingdom or the stench of the city. You ask the waiter to bring a variety of things: Pastries, cakes, sweets, different juices and milks, just so your lady can have a taste of everything.\n\nWhen you finish ordering, you turn around to look at Helena, who is lost in the beauty of the sights. You ask her what she is thinking, and she reacts as if you took her out of a trance. <i>“Eh! N-nothing. I mean, it’s just that I’ve never had a view of the city before that was so beautiful. It is almost as if the city was untouched. No plagues, no fears, just peace and harmony.”</i> You are happy that she can appreciate something like this, since you are sure that most of the people who have the power and wealth to come here don't give a single fuck about the view. \n\nYou switch topics while waiting for the food, talking about past adventures and anecdotes, fears and joys. Helena begins to relax with you as she opens up a bit more, and the mood is further elevated when the delicacies arrive. Her eyes open wide at her options, and she doesn't even know where to start. \n\nShe begins with the dishes that are closest to her, and you never knew she could eat this much, although with all the work she does and the meager food that the servitude receives it’s no wonder that she is this hungry. You love her happy face, delighted by the sweet taste of good cuisine, and you stay quiet letting her enjoy herself.\n\nAfter a while she notices that you are only looking at her and she becomes self conscious. <i>“...Don’t you want some "+ sirPronoun +"? It’s amazing!”</i> She says, with a hint of shame, but you kindly refuse her, and although she keeps tasting the food and consuming the variety of drinks, she slows down and starts to speak again, about how she has always liked sweet things but almost never had the chance to eat them. <i>“I had a dessert once, on my 15 birthday party, but beyond that we barely had enough food to keep going… let along indulge in sweets.”</i> She looks nostalgic once more, but when she notices that you feel bad for her, she cheers up and quickly tries to change the mood. <i>“"+ sirPronoun +", that’s the past, right now, I am as lucky as ever to have y... To have a "+lordPronoun+" like you.”</i> You know she wants to say something else, not sure what, but at the end she probably thinks that she, just being a mere servant, only can dream about having any other kind of relationship other than boss-employee.\n\nOnce she is full of food, you wait a little bit more, as you enjoy her presence and the place a little more before going back. When you arrive to the castle, you ask her if she liked the... Date? Or whatever the hell that was. She answers with a very deep bow. <i>“Of course, it was great.”</i> You ask her if she would like to go outside again in the future, and she suddenly stands up again. <i>“Wha... Really "+ sirPronoun +"? I mean! Yes! Yes, of course! I would love too!”</i> You smile and thank her for the good time, and tell her that she can have the rest of the day off. ";
		} else {
			return "You’ve been thinking of Helena since the last time that both of you went out on that sudden, informal date. Although you know that it may be complicated to be dating someone of lower status, mostly because of your reputation, you really felt like there is a connection between the two of you. Helena shares many things in common with you that you can relate to; A harsh past with no family, but she remains someone who can look towards the future with hope. You still worry and stress about her feelings towards you, since you’re the "+lordPronoun+" of the city, facing hypocrisy and deceit is part of your routine. She wouldn’t do that to you though, would she?\n\nNonetheless, she doesn’t seem to be the kind of woman that is going after your power or wealth, and you really feel like she offers you an opportunity to be with someone as loyal and caring as her. \n\nYou look for Helena and find her just in time before she leaves to the city with a fellow servant and friend, Phoebe. It seems the two of them are off to do some work. You ask Phoebe if she could find another servant to aid her in her trip, as you have a job for Helena, and she answers with a small nod before returning to the castle, leaving both of you alone.\n\n<i>“Is anything wrong "+ sirPronoun +", am I in trouble?”</i>  You smirk and tell her that she is fine. It’s just that you’ve been thinking about it and you wondered if she was interested in going for a stroll with you through the park. <i>“Like a date?!”</i> she blurts out but hastily covers her mouth with her hands, as if she said something very wrong. You calm her down and tell her that yes, exactly like that. She is so shocked that she just nods quickly without removing her hands from her mouth, her eyes growing wider by the second. You have never seen her so nervous before! The way she is reacting is so adorable, simply the best! You give her your arm for her to hold, and she slowly takes it, as if fearing that this is some kind of cruel prank or even a dream. Once she grabs your arm you can feel her holding you hard and shaking a little. You gently pat her head and look into her eyes, telling her to come along.\n\nWhen you arrive at the park, you request that guards close it. It may not be empty, but you would like to have as much of the park to yourselves as possible. Helena has softened her grip on you, and has relaxed a bit, but all she can manage to do is look at the ground as you walk. The last outing the two of you had was so sudden that it almost didn’t seem like a date, but this time your intentions were declared at the start.\n\nAs you stroll, you admit to her that you enjoy her company. Her presence, friendship, and loyalty has made the castle feel like home to you. <i>“I... I also… it does feel, I mean I think it’s home now, thanks to you...”</i> Helena stumbles over her words as she whispers them to you, trying to keep herself together. You turnt of ace her and hold her hands, telling her that she shouldn’t have any need to be afraid of you, and that you feel the same way that she does. She turns her face to the side, her cheeks glowing red. <i>“I-I’m just a servant, "+ sirPronoun +"... You... You shouldn’t worry or have to settle for me… there are many great ladies in the city, I...”</i> She stops, you can see that her eyes have filled with tears. You hug her tightly, patting her back and stroking her hair as you tell her that it doesn’t matter to you, and that you chose her and no one else.\n\nShe calms down and rests her head on your chest, hearing your heartbeat and feeling your breathing. She lingers there, enjoying the moment. \n\nYou decide to return to the castle, as the stroll was much more intense than you thought it would be. Once you reach the gates of your home, Helena stops you and thanks you for everything, as she ask you for forgiveness for her previous behavior. She confirms you that her feelings are as strong as yours, and that if you want she really wants to go out again on a date with you. You give her a very gentle smile and tell her that it is sure to happen and that you would love to. You turn back to walk towards the castle but she stops you by holding your arm, turns you over and leans forward to give you a small, little peck on your lips, before running back inside, full of happiness.  ";
		}
	}

	string date1(){
		Random.InitState (WorldControl.day * System.DateTime.Now.Millisecond + WorldControl.dayTime); 
		randNum = Random.Range (0, 100);
		if (randNum > 50) {
			return "You’ve been dating Helena for a while now, but today you want to take a step further and ask her to be your girlfriend, going past the relationship of "+lordPronoun+" and Servant. She will keep doing her duties as usual, as you really don't have anyone else like her to take care of that, but you have a feeling in your gut that Helena will not truly open herself to you until you do this. \n\nYou give a list of orders to your servants, consisting of acquiring a few things. You need a picnic blanket, as well as your best wine, and a basket filled with Helena’s favorite pastries from your first date. Lastly, you instruct them that once you are in the garden that you must not be disturbed under any circumstance unless it is a complete emergency. \n\nOnce everything is ready, you decide to surprise Helena. You find her overseeing some repairs that are going on in the training room. You call her out loud and ask her to accompany you, but she says she is busy at the moment. What a dutiful young miss. Without hesitation, you give her repairmen the day off, with pay. Done, she’s free now. She gives you a skeptical look, knowing that something is going on, but your eagerness means that whatever it is, it has to be good.\n\nShe follows you into the garden, and when both of you arrive, she asks why there is no one in sight. You don't answer to her question and keep walking until you find the spot that has everything ready for them to just sit down and enjoy. Your servants did an excellent job, everything needed is in place!\n\n<i>“Ah! A picnic! Really?!”</i> She exclaims, in shock at the preparations. You mention to her that you remembered her dreams of a picnic, similar to the ones she read in romance novels. A dream that some time ago was impossible, but now had every opportunity to come true.  \n\nBoth of you sit on the sheet, and you notice that the feel of cloth and soft grass is a nice change of pace. You ask her to open the basket and she lets out a small shriek of happiness. <i>“Oh, these are my favorite pastries! You did remember!”</i> She moves to your side to give you a peck on the cheek as you serve yourself some wine, and you hug her with one arm while she enjoys herself.\n\nShe asks if there is any fruit and you take a strawberry, moving it slowly into her face to feed her. She childishly smiles and once is in range she quickly takes it with her mouth, but a small thread of its juice runs down her lips. You grab a napkin and place your hand against her cheek as you feel her warmth before gently cleaning her up.\n\nHelena flushes red at this, and stays immobile while you are holding her, and you pass your finger over her pursed lips, feeling their softness. She bites your finger softly and closes her eye as you lean forward, putting your forehead against her, both noses touching. You can feel her heavy, hot breath, as she shakes, nervous about what is about to happen. You slowly advance until your lips are together. She stays stiff for a second, but gives into the pleasure then she welcomes your tongue that slowly enters hers, timidly moving her own. \n\nYou grab her and slowly push her until she is lying down at the grass, right under you, and you start to kiss her more passionately, sucking her lips and strongly caressing her tongue with yours.\n\nHelena is panting, and you pause and ask if everything is fine. <i>“Heh... Yes, of course it's fine, is... Ah... I feel weird... My feelings are...”</i> You gently shush her and tell her to just enjoy the moment, as you kiss her again. \n\nEventually, your lips separate, momentarily, to take a break. Your jaw begins to tighten up a little but to your surprise. You cuddle up to her side, as both of you stare up at the empty blue sky. <i>“You have done so much for me... I mean, you pretty much saved me... I just...”</i> You cut her off and tell her that she owes you nothing and that she should stop with that mentality.  You look at her eyes and ask her if she really corresponds your feelings, if she wants to be in a relationship with you. <i>“Ah!...Y-Yes!”</i> her trembling voice squeaking out an answer, making her even cuter. \n\nHer response overflows you with feelings. You embrace her and lie on her chest, feeling exhausted even if there is no real reason for it. You chest grows tight with joy and excitement. You fall asleep on her breasts, and when you wake up you can feel her hands on your head, and as you look up you see her sleeping too. \n\nYou stand up and clean up parts of the picnic before waking her up. <i>“Ha... Darling... I slept so well...”</i> She says while you give her a hand to help her stand up. She gives you a kiss on your lips and begins to grab the picnic basket. <i>“Don’t worry, I’ll take this inside, there is a lot of work to do and I think I distracted you enough for today I... See you around, okay, honey?”</i> Her cheerful smile and sweet words gives you comfort. You nod at her and take a different path to the castle. ";
		} else {
			return "Your love to Helena has been growing since you decided to strengthen your bond with her, and you are sure that her feelings for you has increased too. \n\nIn order to take the last step to really cement your relationship, you need to do something really big, but you spend many days wondering what can be appropriate, until you remember that she told you that she loved to go to the Amphitheater when she was young, until they closed it due to the Plague, and this gives you an idea. \n\nThe cultural zone of the city is one of the most affected ones, and although the city has been recovering in the past weeks there is still a lot of work to do to finish the repairs. Even so, the houses here owe you much and a small favor like asking for the amphitheater for a night isn’t too much to ask. You go to Abbadon’s house and you reach an agreement for her to lend you the place for a night in exchange of some boring and simple political favors\n\nYou also arrange with the performing company to perform a classic romantic comedy that night. Once everything is ready, you go and buy a beautiful and somewhat modest white dress, with silk gloves and white gold jewelry to give Helena as a present. \n\nWhen you come back to the castle, you call out for Helena and she scurries down the stairs. -Hey darling, were you looking for me?.- You tell her that you have a surprise for her, and she just jumps in excitement. -What it is? What it is?.- You ask her to calm down while you take the dress from the bag. <i>“Wooow! it's beautiful! Is... Is it really for me? You shouldn’t have!”</i> You tell her that it's nothing, and that in a couple of days you both are going out in a date and she might need this dress for it. She happily agrees and kisses you before running to her room to try it on.\n\nWhen the sun settles on the day of the play, you are ready to go and are waiting for Helena to show herself in the throne room. You can hear her walking downstairs, each of her steps are slow and cautious because she is probably using the high heels you gave her. Once you have a sight of her, you are impressed, she looks way more beautiful than you expected! Her white dress fits her perfectly and even if its modest, it highlights her curves and bust, which makes her look sexy and somewhat provocative. Her makeup and jewelry give her a sense of class, and she looks better than most of the high class ladies in the city. \n\nAs you stand there, taken back by her beauty, she stumbles as she reaches the last steps. She might look like high class, but her mannerisms and experiences are still her, but it’s not like it matters. You take her hand and kiss it, to which she just giggles and blushes. <i>“Let’s go sweetheart, I am ready.”</i> You compliment her looks as you offer your arm for her to take. She happily does, and the two of you make your way.\n\n<i>“So... are you gonna tell me where are we going or it will be a surprise? Then again, almost all of our dates are surprise.”</i> She asks, and she does have a point. Every time you take her away, you give her little to information. You tell her that she mustn’t be impatient, that she should just enjoy the ride. The streets were almost empty due to a recent decree, and you had a healthy amount of guards escorting you just to make sure that nothing interrupts your night. You finally reach the cultural district and Helena’s face lights up, although she keeps quiet for the rest of the trip.\n\nYou can feel her heartbeat increase, and her grip gets tighter too as you approach the building she longed for. When you hear her sniffing you turn and see that she is struggling to avoid crying, overwhelmed with emotions. Before entering the place, you hug her and stroke her hair, calming her down. You call her your little queen and that she shouldn’t be crying. <i>“I-I know... I’m just so happy and you’ve done just so much for me… I just wish I could do something like this for you too...”</i> You tell her not to worry, and that you never expected her to do so. You reassure her that you love her for who she is, not for what she has, and that you are lucky to had inherited a title when you were struggling in the forest, but even more lucky to meet her. After all these times she has taken care of you, you almost owe her, you joke. She hugs you hard and although she is unable to contain her tears, she decides to lean forward and give you a deep kiss until she she starts to feel more serene. \n\n<i>“Okay... I'm feeling better now, let's go.”</i> She says, cheered up again. You get at the gates of the place and a couple of guards open it for you. Beyond the actors, the place is totally empty, and you feel an odd sense of tranquility and peace. You walk toward the first row, where they installed premium seats to use, accompanied with some refreshments at the sides as well as a blanket and a small bell to call for a waiter. This is the best of the best treatment anyone could experience at the theater. \n\nBoth of you take your seats, holding hands as Helena giddily talks about the building and other plays. When the entertainers are ready, a very loud Taiko drum is beat at your back, and you laugh when Helena almost jumps out of her seat by the surprise. The play is a romantic comedy about two lovers that can’t be together by ridiculous and arbitrary circumstances, and mostly fearing the wrath and gossip of their peers, until they both end up saving the day and earning their place in the city. \n\nHelena is totally immersed in the play, and her only distraction is eating pastries from a tray on her legs. You decide to just let her enjoy the moment, lie down and relax until it's over. Everything goes smoothly and just as planned. Helena stands up to give them a standing ovation while they bow and thanks the audience for the opportunity to act once again. \n\nThe staff and actors leave but you and Helena decide to stay there a little longer, talking about what she liked the most and the least of the play. When everyone else has left, you are lying down looking at the sky with her. <i>“It’s been a fantastic night, I never dreamed... Of something like this. Being in first row, eating delicious food, a private play it's just... Magical...”</i> Her voice sounds almost nostalgic, but filled with wonder and joy. Before you can say anything else, she continues. <i>“...And, what I never expected in my life, was you... You are something that goes beyond any dream I could ever have, you are truly unique and precious and I... I-I love you!”</i> Her eyes are fixed on you, anxious for your answer. You can feel her hand holding yours with all of her strength, as if her life depended on not letting you go, and her heavy breath lingering heavily within the cold night. \n\nYou declare your love for her too, and she immediately jumps on you with that answer, kissing you, playing with your hair and caressing your face. When passion wears off she lies on your chests and looks at you while you look at the stars. She has always been more than a mere servant, more than a casual relationship, and you truly want to be with her.\n\nBoth of you fall asleep in the open, blessed with great weather, and when the morning comes you feel that your bond with Helena is as strong as it has ever been. She is still sleepy, and you decide to pick her up and carry her back to the castle. ";
		}
	}

	void loadHelenaData(){
		iHelena = 0;

		while (iHelena < NPCCharList.CharFollower.Count) {
			if(NPCCharList.CharFollower [iHelena].charID >= 3000 && NPCCharList.CharFollower [iHelena].charID < 4000){
				WorldControl.NPCID = NPCCharList.CharFollower [iHelena].charID;
				WorldControl.PortraitIDLayer0 = NPCCharList.CharFollower [iHelena].charPortraitLayer0;
				WorldControl.PortraitIDLayer1 = NPCCharList.CharFollower [iHelena].charPortraitLayer1;
				WorldControl.PortraitIDLayer2 = NPCCharList.CharFollower [iHelena].charPortraitLayer2;
				WorldControl.furryPic = NPCCharList.CharFollower [iHelena].isFurry;
				WorldControl.futaPic = NPCCharList.CharFollower [iHelena].isFuta;
				break; 
			}
			iHelena++;

		}

	}


	void endTurnFun(){
		PanLeftManagement.endTurnControl = true; 
		panMainPanel.sortingOrder = -500; 
		endTurnPanel.sortingOrder = 500;
	}
}
